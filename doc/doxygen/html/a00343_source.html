<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>dune-istl: preconditioners.hh Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">dune-istl
   &#160;<span id="projectnumber">2.2.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5e69be5995c9f5d42bf491ae6f29600e.html">dune</a></li><li class="navelem"><a class="el" href="dir_5e12c67a8fe12cf8b78c94f3b4cb9926.html">istl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">preconditioners.hh</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a00343.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// -*- tab-width: 8; indent-tabs-mode: nil; c-basic-offset: 2 -*-</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// vi: set et ts=8 sw=2 sts=2:</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#ifndef DUNE_PRECONDITIONERS_HH</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define DUNE_PRECONDITIONERS_HH</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include&lt;cmath&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include&lt;complex&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include&lt;iomanip&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include&lt;string&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="a00353.html">solvercategory.hh</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00322.html">istlexception.hh</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00331.html" title="Some handy generic functions for ISTL matrices.">matrixutils.hh</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00321.html" title="Some generic functions for pretty printing vectors and matrices.">io.hh</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00313.html" title="Simple iterative methods like Jacobi, Gauss-Seidel, SOR, SSOR, etc. in a generic way.">gsetc.hh</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00315.html" title="???">ilu.hh</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">namespace </span>Dune {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span>  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> X, <span class="keyword">class</span> Y&gt;</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="code" href="a00204.html">   74</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a00204.html" title="Base class for matrix free definition of preconditioners.">Preconditioner</a> {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="code" href="a00204.html#a5b532d75c242b8d5989472b9c9215571">   77</a></span>&#160;    <span class="keyword">typedef</span> X <a class="code" href="a00204.html#a5b532d75c242b8d5989472b9c9215571" title="The domain type of the preconditioner.">domain_type</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="code" href="a00204.html#a5a46bb9abdeb1f4bb775e0ad059e84a3">   79</a></span>&#160;    <span class="keyword">typedef</span> Y <a class="code" href="a00204.html#a5a46bb9abdeb1f4bb775e0ad059e84a3" title="The range type of the preconditioner.">range_type</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="code" href="a00204.html#ab0b3774d7f930f012ae0d9aa8431e565">   81</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> X::field_type <a class="code" href="a00204.html#ab0b3774d7f930f012ae0d9aa8431e565" title="The field type of the preconditioner.">field_type</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00204.html#ad524e05b6c42f49fbe8b29577ae67265" title="Prepare the preconditioner.">pre</a> (X&amp; x, Y&amp; b) = 0;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00204.html#a05b45208eec670e82b65bbc8e2601af0" title="Apply one step of the preconditioner to the system A(v)=d.">apply</a> (X&amp; v, <span class="keyword">const</span> Y&amp; d) = 0;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00204.html#a02d7633248cb4c68af7e0e787ec4029d" title="Clean up.">post</a> (X&amp; x) = 0;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="comment">// every abstract base class has a virtual destructor</span></div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="code" href="a00204.html#a0f7351d4552bbfa54de527768f36a151">  123</a></span>&#160;        <span class="keyword">virtual</span> <a class="code" href="a00204.html#a0f7351d4552bbfa54de527768f36a151">~Preconditioner</a> () {}</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  };</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// Implementation of this interface for sequential ISTL-preconditioners</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">//=====================================================================</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> M, <span class="keyword">class</span> X, <span class="keyword">class</span> Y, <span class="keywordtype">int</span> l=1&gt;</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="code" href="a00250.html">  144</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a00250.html" title="Sequential SSOR preconditioner.">SeqSSOR</a> : <span class="keyword">public</span> <a class="code" href="a00204.html" title="Base class for matrix free definition of preconditioners.">Preconditioner</a>&lt;X,Y&gt; {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="code" href="a00250.html#ab9aaf438a086ec04c9a29f77f144d7b8">  147</a></span>&#160;    <span class="keyword">typedef</span> M <a class="code" href="a00250.html#ab9aaf438a086ec04c9a29f77f144d7b8" title="The matrix type the preconditioner is for.">matrix_type</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="code" href="a00250.html#ab43f1555220cf61b9df1b5474d85c751">  149</a></span>&#160;    <span class="keyword">typedef</span> X <a class="code" href="a00250.html#ab43f1555220cf61b9df1b5474d85c751" title="The domain type of the preconditioner.">domain_type</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="code" href="a00250.html#ae0be15bb4a594b37b802605715337c0c">  151</a></span>&#160;    <span class="keyword">typedef</span> Y <a class="code" href="a00250.html#ae0be15bb4a594b37b802605715337c0c" title="The range type of the preconditioner.">range_type</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="code" href="a00250.html#a81831aed301d8c4069ce92ca9138c5b8">  153</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> X::field_type <a class="code" href="a00250.html#a81831aed301d8c4069ce92ca9138c5b8" title="The field type of the preconditioner.">field_type</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// define the category</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keyword">enum</span> {</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="code" href="a00250.html#ab7f7995158f23c9345a07b1048b48bd9ab0467e6dc9685ca2182192bfb46b8b50">  158</a></span>&#160;      <a class="code" href="a00250.html#ab7f7995158f23c9345a07b1048b48bd9ab0467e6dc9685ca2182192bfb46b8b50" title="The category the preconditioner is part of.">category</a>=<a class="code" href="a00262.html#ae061380ac961490be6ee353cf0dc1733add8be425650b870002d9381aea1203b9" title="Category for sequential solvers.">SolverCategory::sequential</a>};</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    </div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="code" href="a00250.html#a5c28686b886c740ca18b2f3bff550456">  167</a></span>&#160;    <a class="code" href="a00250.html#a5c28686b886c740ca18b2f3bff550456" title="Constructor.">SeqSSOR</a> (<span class="keyword">const</span> M&amp; <a class="code" href="a00369.html#gaaf9526ceb06c2a3425a0d91eec5dffe8">A</a>, <span class="keywordtype">int</span> n, <a class="code" href="a00204.html#ab0b3774d7f930f012ae0d9aa8431e565" title="The field type of the preconditioner.">field_type</a> w)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      : _A_(A), _n(n), _w(w)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="a00051.html" title="Check whether the a matrix has diagonal values on blocklevel recursion levels.">CheckIfDiagonalPresent&lt;M,l&gt;::check</a>(_A_);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="code" href="a00250.html#ad9c70194d013fe400d244206c063a6d4">  178</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00250.html#ad9c70194d013fe400d244206c063a6d4" title="Prepare the preconditioner.">pre</a> (X&amp; x, Y&amp; b) {}</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="code" href="a00250.html#ac85e34f610d11d6074648690b601e105">  185</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00250.html#ac85e34f610d11d6074648690b601e105" title="Apply the preconditioner.">apply</a> (X&amp; v, <span class="keyword">const</span> Y&amp; d)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;_n; i++){</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <a class="code" href="a00377.html#gaf2caef773a37fd65ee1fa76ee0a95c47" title="SOR step.">bsorf</a>(_A_,v,d,_w,<a class="code" href="a00043.html" title="compile-time parameter for block recursion depth">BL&lt;l&gt;</a>());</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="a00377.html#ga3a70747a68e23231ab6cb72b396942ec" title="SSOR step.">bsorb</a>(_A_,v,d,_w,<a class="code" href="a00043.html" title="compile-time parameter for block recursion depth">BL&lt;l&gt;</a>());</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="code" href="a00250.html#a0415c92193b307dfeb116cb91c806167">  198</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00250.html#a0415c92193b307dfeb116cb91c806167" title="Clean up.">post</a> (X&amp; x) {}</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keyword">const</span> M&amp; _A_;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">int</span> _n;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="a00250.html#a81831aed301d8c4069ce92ca9138c5b8" title="The field type of the preconditioner.">field_type</a> _w;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  };</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> M, <span class="keyword">class</span> X, <span class="keyword">class</span> Y, <span class="keywordtype">int</span> l=1&gt;</div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="code" href="a00249.html">  223</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a00249.html" title="Sequential SOR preconditioner.">SeqSOR</a> : <span class="keyword">public</span> <a class="code" href="a00204.html" title="Base class for matrix free definition of preconditioners.">Preconditioner</a>&lt;X,Y&gt; {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="code" href="a00249.html#a19c8b9476931e56f9c086e12fee9dbe5">  226</a></span>&#160;    <span class="keyword">typedef</span> M <a class="code" href="a00249.html#a19c8b9476931e56f9c086e12fee9dbe5" title="The matrix type the preconditioner is for.">matrix_type</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="code" href="a00249.html#a59e703c6a6c3b5114828466edeb579ba">  228</a></span>&#160;    <span class="keyword">typedef</span> X <a class="code" href="a00249.html#a59e703c6a6c3b5114828466edeb579ba" title="The domain type of the preconditioner.">domain_type</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="code" href="a00249.html#abe12d0acefc8e81c045c8105d943c74c">  230</a></span>&#160;    <span class="keyword">typedef</span> Y <a class="code" href="a00249.html#abe12d0acefc8e81c045c8105d943c74c" title="The range type of the preconditioner.">range_type</a>;</div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="code" href="a00249.html#af0936a1bb7f8855b219e31cb72b39588">  232</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> X::field_type <a class="code" href="a00249.html#af0936a1bb7f8855b219e31cb72b39588" title="The field type of the preconditioner.">field_type</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// define the category</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keyword">enum</span> {</div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="code" href="a00249.html#a73adea946f6ce34cd4fea107ec1b0567a436b74bd4990e00004bde1ec013738cf">  237</a></span>&#160;      <a class="code" href="a00249.html#a73adea946f6ce34cd4fea107ec1b0567a436b74bd4990e00004bde1ec013738cf" title="The category the preconditioner is part of.">category</a>=<a class="code" href="a00262.html#ae061380ac961490be6ee353cf0dc1733add8be425650b870002d9381aea1203b9" title="Category for sequential solvers.">SolverCategory::sequential</a></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    };</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="code" href="a00249.html#a5166f225bf8914becfd03f195cb25278">  247</a></span>&#160;    <a class="code" href="a00249.html#a5166f225bf8914becfd03f195cb25278" title="Constructor.">SeqSOR</a> (<span class="keyword">const</span> M&amp; <a class="code" href="a00369.html#gaaf9526ceb06c2a3425a0d91eec5dffe8">A</a>, <span class="keywordtype">int</span> n, <a class="code" href="a00204.html#ab0b3774d7f930f012ae0d9aa8431e565" title="The field type of the preconditioner.">field_type</a> w)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      : _A_(A), _n(n), _w(w)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <a class="code" href="a00051.html" title="Check whether the a matrix has diagonal values on blocklevel recursion levels.">CheckIfDiagonalPresent&lt;M,l&gt;::check</a>(_A_);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="code" href="a00249.html#a6f1a33b78fe15037894dd10476dedb66">  258</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00249.html#a6f1a33b78fe15037894dd10476dedb66" title="Prepare the preconditioner.">pre</a> (X&amp; x, Y&amp; b) {}</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="code" href="a00249.html#aae877d1d5884ebe5d47f2f140d28b144">  265</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00249.html#aae877d1d5884ebe5d47f2f140d28b144" title="Apply the preconditioner.">apply</a> (X&amp; v, <span class="keyword">const</span> Y&amp; d)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      this-&gt;<span class="keyword">template</span> apply&lt;true&gt;(v,d);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keyword">template</span>&lt;<span class="keywordtype">bool</span> forward&gt;</div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="code" href="a00249.html#a3261a46d3c625a277b928f3233aa84cb">  279</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="a00249.html#aae877d1d5884ebe5d47f2f140d28b144" title="Apply the preconditioner.">apply</a>(X&amp; v, <span class="keyword">const</span> Y&amp; d)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">if</span>(forward)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;_n; i++){</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          <a class="code" href="a00377.html#gaf2caef773a37fd65ee1fa76ee0a95c47" title="SOR step.">bsorf</a>(_A_,v,d,_w,<a class="code" href="a00043.html" title="compile-time parameter for block recursion depth">BL&lt;l&gt;</a>());</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;_n; i++){</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;          <a class="code" href="a00377.html#ga3a70747a68e23231ab6cb72b396942ec" title="SSOR step.">bsorb</a>(_A_,v,d,_w,<a class="code" href="a00043.html" title="compile-time parameter for block recursion depth">BL&lt;l&gt;</a>());</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="code" href="a00249.html#a612b2731badd9d62779cee48998e7649">  296</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00249.html#a612b2731badd9d62779cee48998e7649" title="Clean up.">post</a> (X&amp; x) {}</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keyword">const</span> M&amp; _A_;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">int</span> _n;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="a00249.html#af0936a1bb7f8855b219e31cb72b39588" title="The field type of the preconditioner.">field_type</a> _w;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  };</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> M, <span class="keyword">class</span> X, <span class="keyword">class</span> Y, <span class="keywordtype">int</span> l=1&gt;</div>
<div class="line"><a name="l00319"></a><span class="lineno"><a class="code" href="a00231.html">  319</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a00231.html" title="Sequential Gauss Seidel preconditioner.">SeqGS</a> : <span class="keyword">public</span> <a class="code" href="a00204.html" title="Base class for matrix free definition of preconditioners.">Preconditioner&lt;X,Y&gt;</a> {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="code" href="a00231.html#acebb35a42eb76463525dc513358e283d">  322</a></span>&#160;    <span class="keyword">typedef</span> M <a class="code" href="a00231.html#acebb35a42eb76463525dc513358e283d" title="The matrix type the preconditioner is for.">matrix_type</a>;</div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="code" href="a00231.html#afb1166391724d7bb87f47559095c4f6f">  324</a></span>&#160;    <span class="keyword">typedef</span> X <a class="code" href="a00231.html#afb1166391724d7bb87f47559095c4f6f" title="The domain type of the preconditioner.">domain_type</a>;</div>
<div class="line"><a name="l00326"></a><span class="lineno"><a class="code" href="a00231.html#a45896ee8de2b13555b8c3f508a7198d2">  326</a></span>&#160;    <span class="keyword">typedef</span> Y <a class="code" href="a00231.html#a45896ee8de2b13555b8c3f508a7198d2" title="The range type of the preconditioner.">range_type</a>;</div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="code" href="a00231.html#a7c03fabe49d5f1c8b908dc70f951b09a">  328</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> X::field_type <a class="code" href="a00231.html#a7c03fabe49d5f1c8b908dc70f951b09a" title="The field type of the preconditioner.">field_type</a>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// define the category</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">enum</span> {</div>
<div class="line"><a name="l00333"></a><span class="lineno"><a class="code" href="a00231.html#a004dfec2f102e8fbc5eeeaf7b9004e9fa15dccc45865a600930b965021ee86dad">  333</a></span>&#160;      category=<a class="code" href="a00262.html#ae061380ac961490be6ee353cf0dc1733add8be425650b870002d9381aea1203b9" title="Category for sequential solvers.">SolverCategory::sequential</a></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    };</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="code" href="a00231.html#a2eb0a8720e629e5bb8eb61d4d1648e28">  343</a></span>&#160;    <a class="code" href="a00231.html" title="Sequential Gauss Seidel preconditioner.">SeqGS</a> (<span class="keyword">const</span> M&amp; <a class="code" href="a00369.html#gaaf9526ceb06c2a3425a0d91eec5dffe8">A</a>, <span class="keywordtype">int</span> n, field_type w)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      : _A_(A), _n(n), _w(w)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <a class="code" href="a00051.html#a2638a8b983b323317a3f52a57f2e1ed6" title="Check whether the a matrix has diagonal values on blocklevel recursion levels.">CheckIfDiagonalPresent&lt;M,l&gt;::check</a>(_A_);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="code" href="a00231.html#a1c786c0731370eb72b036b4fe1d0c8e9">  354</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00231.html#a1c786c0731370eb72b036b4fe1d0c8e9" title="Prepare the preconditioner.">pre</a> (X&amp; x, Y&amp; b) {}</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    </div>
<div class="line"><a name="l00361"></a><span class="lineno"><a class="code" href="a00231.html#abb0234849af92916ed4587cfad427028">  361</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> apply (X&amp; v, <span class="keyword">const</span> Y&amp; d)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;_n; i++){</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <a class="code" href="a00377.html#ga5bec8914ff3d25fb86ddffef6e38677d" title="GS step.">dbgs</a>(_A_,v,d,_w,<a class="code" href="a00043.html" title="compile-time parameter for block recursion depth">BL&lt;l&gt;</a>());</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno"><a class="code" href="a00231.html#a035068f4f51bfab7b8efc6ad29664bfa">  373</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00231.html#a035068f4f51bfab7b8efc6ad29664bfa" title="Clean up.">post</a> (X&amp; x) {}</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keyword">const</span> M&amp; _A_;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">int</span> _n;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    field_type _w;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  };</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> M, <span class="keyword">class</span> X, <span class="keyword">class</span> Y, <span class="keywordtype">int</span> l=1&gt;</div>
<div class="line"><a name="l00396"></a><span class="lineno"><a class="code" href="a00234.html">  396</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a00234.html" title="The sequential jacobian preconditioner.">SeqJac</a> : <span class="keyword">public</span> <a class="code" href="a00204.html" title="Base class for matrix free definition of preconditioners.">Preconditioner&lt;X,Y&gt;</a> {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00399"></a><span class="lineno"><a class="code" href="a00234.html#a35be4fb3c1cc34a64a76a3eb35e01a37">  399</a></span>&#160;    <span class="keyword">typedef</span> M <a class="code" href="a00234.html#a35be4fb3c1cc34a64a76a3eb35e01a37" title="The matrix type the preconditioner is for.">matrix_type</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="code" href="a00234.html#aad91bd37afbb53c8542f72b93a51148a">  401</a></span>&#160;    <span class="keyword">typedef</span> X <a class="code" href="a00234.html#aad91bd37afbb53c8542f72b93a51148a" title="The domain type of the preconditioner.">domain_type</a>;</div>
<div class="line"><a name="l00403"></a><span class="lineno"><a class="code" href="a00234.html#aed41ed8906cd4910ff9ed6a15d44edd0">  403</a></span>&#160;    <span class="keyword">typedef</span> Y <a class="code" href="a00234.html#aed41ed8906cd4910ff9ed6a15d44edd0" title="The range type of the preconditioner.">range_type</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="code" href="a00234.html#a65cf060da925ea66168eb8e20156c1c1">  405</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> X::field_type <a class="code" href="a00234.html#a65cf060da925ea66168eb8e20156c1c1" title="The field type of the preconditioner.">field_type</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// define the category</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keyword">enum</span> {</div>
<div class="line"><a name="l00410"></a><span class="lineno"><a class="code" href="a00234.html#a3b35f29ace9fec90015bd00da6c0473fabf0dc6aa83c87252052240dc5e4f0d5e">  410</a></span>&#160;      category=<a class="code" href="a00262.html#ae061380ac961490be6ee353cf0dc1733add8be425650b870002d9381aea1203b9" title="Category for sequential solvers.">SolverCategory::sequential</a></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    };</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno"><a class="code" href="a00234.html#a76deb1b1ef5fb44fcd7262d138ce523d">  420</a></span>&#160;    <a class="code" href="a00234.html" title="The sequential jacobian preconditioner.">SeqJac</a> (<span class="keyword">const</span> M&amp; <a class="code" href="a00369.html#gaaf9526ceb06c2a3425a0d91eec5dffe8">A</a>, <span class="keywordtype">int</span> n, field_type w)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      : _A_(A), _n(n), _w(w)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <a class="code" href="a00051.html#a2638a8b983b323317a3f52a57f2e1ed6" title="Check whether the a matrix has diagonal values on blocklevel recursion levels.">CheckIfDiagonalPresent&lt;M,l&gt;::check</a>(_A_);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno"><a class="code" href="a00234.html#a935edb213820ca75d33fbbeb02763ee6">  431</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00234.html#a935edb213820ca75d33fbbeb02763ee6" title="Prepare the preconditioner.">pre</a> (X&amp; x, Y&amp; b) {}</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="code" href="a00234.html#a2e55a1752f387e30c5a10f8a026aa7cb">  438</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> apply (X&amp; v, <span class="keyword">const</span> Y&amp; d)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;_n; i++){</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <a class="code" href="a00377.html#ga51ae0ff4aea09b29d3f31ae2f6dfacc5" title="Jacobi step.">dbjac</a>(_A_,v,d,_w,<a class="code" href="a00043.html" title="compile-time parameter for block recursion depth">BL&lt;l&gt;</a>());</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno"><a class="code" href="a00234.html#a1cd43fca57cf3f807cff37d7ede57718">  450</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00234.html#a1cd43fca57cf3f807cff37d7ede57718" title="Clean up.">post</a> (X&amp; x) {}</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keyword">const</span> M&amp; _A_;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordtype">int</span> _n;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    field_type _w;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  };</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> M, <span class="keyword">class</span> X, <span class="keyword">class</span> Y, <span class="keywordtype">int</span> l=1&gt;</div>
<div class="line"><a name="l00475"></a><span class="lineno"><a class="code" href="a00232.html">  475</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a00232.html" title="Sequential ILU0 preconditioner.">SeqILU0</a> : <span class="keyword">public</span> <a class="code" href="a00204.html" title="Base class for matrix free definition of preconditioners.">Preconditioner&lt;X,Y&gt;</a> {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00478"></a><span class="lineno"><a class="code" href="a00232.html#a2043c871f3f202851c8413051cac8467">  478</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="a00328.html#a781d34a2370bdc61ad2eea4fa191dd06">Dune::remove_const&lt;M&gt;::type</a> <a class="code" href="a00232.html#a2043c871f3f202851c8413051cac8467" title="The matrix type the preconditioner is for.">matrix_type</a>;</div>
<div class="line"><a name="l00480"></a><span class="lineno"><a class="code" href="a00232.html#ab5f4ad8c4a7e4c04c2911ca33103bacd">  480</a></span>&#160;    <span class="keyword">typedef</span> X <a class="code" href="a00232.html#ab5f4ad8c4a7e4c04c2911ca33103bacd" title="The domain type of the preconditioner.">domain_type</a>;</div>
<div class="line"><a name="l00482"></a><span class="lineno"><a class="code" href="a00232.html#a98c4a2ac1f6468ba2c149da61f9e18e6">  482</a></span>&#160;    <span class="keyword">typedef</span> Y <a class="code" href="a00232.html#a98c4a2ac1f6468ba2c149da61f9e18e6" title="The range type of the preconditioner.">range_type</a>;</div>
<div class="line"><a name="l00484"></a><span class="lineno"><a class="code" href="a00232.html#ac9fc3279aa76b3ec7d9ef0b7525321f4">  484</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> X::field_type <a class="code" href="a00232.html#ac9fc3279aa76b3ec7d9ef0b7525321f4" title="The field type of the preconditioner.">field_type</a>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">// define the category</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keyword">enum</span> {</div>
<div class="line"><a name="l00489"></a><span class="lineno"><a class="code" href="a00232.html#a7d0c66fad83bf71bfbc049a351564dbcaca308df07dbeaeb6220bac0028b81dd4">  489</a></span>&#160;      category=<a class="code" href="a00262.html#ae061380ac961490be6ee353cf0dc1733add8be425650b870002d9381aea1203b9" title="Category for sequential solvers.">SolverCategory::sequential</a></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    };</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno"><a class="code" href="a00232.html#a71476eb53bba32b7acd92e813f980233">  498</a></span>&#160;    <a class="code" href="a00232.html" title="Sequential ILU0 preconditioner.">SeqILU0</a> (<span class="keyword">const</span> M&amp; <a class="code" href="a00369.html#gaaf9526ceb06c2a3425a0d91eec5dffe8">A</a>, field_type w)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      : ILU(A) <span class="comment">// copy A</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      _w =w;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <a class="code" href="a00377.html#gae67699f4a1392779203441b91402a834" title="compute ILU decomposition of A. A is overwritten by its decomposition">bilu0_decomposition</a>(ILU);   </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno"><a class="code" href="a00232.html#a37f6c0be0b407b952c76d4e9f4d51950">  510</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00232.html#a37f6c0be0b407b952c76d4e9f4d51950" title="Prepare the preconditioner.">pre</a> (X&amp; x, Y&amp; b) {}</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno"><a class="code" href="a00232.html#a5c5e02154f0a77c8d2ead0a39f372ead">  517</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> apply (X&amp; v, <span class="keyword">const</span> Y&amp; d)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <a class="code" href="a00377.html#ga9a874f8e0ab8b1bd84d6e615f7cde9ee" title="LU backsolve with stored inverse.">bilu_backsolve</a>(ILU,v,d);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      v *= _w;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno"><a class="code" href="a00232.html#a33f7f10bb9cfd27ca1fe964e71d074f0">  528</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00232.html#a33f7f10bb9cfd27ca1fe964e71d074f0" title="Clean up.">post</a> (X&amp; x) {}</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    field_type _w;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    matrix_type ILU;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  };</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> M, <span class="keyword">class</span> X, <span class="keyword">class</span> Y, <span class="keywordtype">int</span> l=1&gt;</div>
<div class="line"><a name="l00552"></a><span class="lineno"><a class="code" href="a00233.html">  552</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a00233.html" title="Sequential ILU(n) preconditioner.">SeqILUn</a> : <span class="keyword">public</span> <a class="code" href="a00204.html" title="Base class for matrix free definition of preconditioners.">Preconditioner&lt;X,Y&gt;</a> {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00555"></a><span class="lineno"><a class="code" href="a00233.html#ac32db32f5a9217af03a1b2ed6cf02066">  555</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="a00328.html#a781d34a2370bdc61ad2eea4fa191dd06">Dune::remove_const&lt;M&gt;::type</a> <a class="code" href="a00233.html#ac32db32f5a9217af03a1b2ed6cf02066" title="The matrix type the preconditioner is for.">matrix_type</a>;</div>
<div class="line"><a name="l00557"></a><span class="lineno"><a class="code" href="a00233.html#a9c5c7a2be18ab33727ba9139b8667dea">  557</a></span>&#160;    <span class="keyword">typedef</span> X <a class="code" href="a00233.html#a9c5c7a2be18ab33727ba9139b8667dea" title="The domain type of the preconditioner.">domain_type</a>;</div>
<div class="line"><a name="l00559"></a><span class="lineno"><a class="code" href="a00233.html#ace930c453b8b4f5c774c5476c0a4de67">  559</a></span>&#160;    <span class="keyword">typedef</span> Y <a class="code" href="a00233.html#ace930c453b8b4f5c774c5476c0a4de67" title="The range type of the preconditioner.">range_type</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno"><a class="code" href="a00233.html#ad9a60ed9c7424f911a0e54cf4c8b0ca7">  561</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> X::field_type <a class="code" href="a00233.html#ad9a60ed9c7424f911a0e54cf4c8b0ca7" title="The field type of the preconditioner.">field_type</a>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">// define the category</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keyword">enum</span> {</div>
<div class="line"><a name="l00566"></a><span class="lineno"><a class="code" href="a00233.html#a94c03967ca830e08998c6a05d2dff179ad7372c64c1f467f7586fecd18ca00822">  566</a></span>&#160;      category=<a class="code" href="a00262.html#ae061380ac961490be6ee353cf0dc1733add8be425650b870002d9381aea1203b9" title="Category for sequential solvers.">SolverCategory::sequential</a></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    };</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00576"></a><span class="lineno"><a class="code" href="a00233.html#a77aa7035f01767843bdaf37b50318c07">  576</a></span>&#160;    <a class="code" href="a00233.html" title="Sequential ILU(n) preconditioner.">SeqILUn</a> (<span class="keyword">const</span> M&amp; <a class="code" href="a00369.html#gaaf9526ceb06c2a3425a0d91eec5dffe8">A</a>, <span class="keywordtype">int</span> n, field_type w)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      : ILU(A.N(),A.M(),M::row_wise)</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      _n = n;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      _w = w;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <a class="code" href="a00377.html#gab9180edeb5a71c5a5fa867a2b395e562">bilu_decomposition</a>(A,n,ILU);        </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div>
<div class="line"><a name="l00589"></a><span class="lineno"><a class="code" href="a00233.html#a25fd11b2b038c5169aa9e0a2590ef1d9">  589</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00233.html#a25fd11b2b038c5169aa9e0a2590ef1d9" title="Prepare the preconditioner.">pre</a> (X&amp; x, Y&amp; b) {}</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno"><a class="code" href="a00233.html#ad26fca5beb7d39b558c64ac236bc948c">  596</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> apply (X&amp; v, <span class="keyword">const</span> Y&amp; d)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <a class="code" href="a00377.html#ga9a874f8e0ab8b1bd84d6e615f7cde9ee" title="LU backsolve with stored inverse.">bilu_backsolve</a>(ILU,v,d);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      v *= _w;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno"><a class="code" href="a00233.html#a73c75bc3e4ae64577d334e454e43315f">  607</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00233.html#a73c75bc3e4ae64577d334e454e43315f" title="Clean up.">post</a> (X&amp; x) {}</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    matrix_type ILU;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordtype">int</span> _n;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    field_type _w;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  };</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keyword">template</span>&lt;<span class="keyword">class</span> X, <span class="keyword">class</span> Y&gt;</div>
<div class="line"><a name="l00629"></a><span class="lineno"><a class="code" href="a00223.html">  629</a></span>&#160;  <span class="keyword">class </span><a class="code" href="a00223.html" title="Richardson preconditioner.">Richardson</a> : <span class="keyword">public</span> <a class="code" href="a00204.html" title="Base class for matrix free definition of preconditioners.">Preconditioner&lt;X,Y&gt;</a> {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00632"></a><span class="lineno"><a class="code" href="a00223.html#ad7e0332b1996202d36d9073d8797ba17">  632</a></span>&#160;    <span class="keyword">typedef</span> X <a class="code" href="a00223.html#ad7e0332b1996202d36d9073d8797ba17" title="The domain type of the preconditioner.">domain_type</a>;</div>
<div class="line"><a name="l00634"></a><span class="lineno"><a class="code" href="a00223.html#a2f5e60b187f2372c6cc1f7100b363b4d">  634</a></span>&#160;    <span class="keyword">typedef</span> Y <a class="code" href="a00223.html#a2f5e60b187f2372c6cc1f7100b363b4d" title="The range type of the preconditioner.">range_type</a>;</div>
<div class="line"><a name="l00636"></a><span class="lineno"><a class="code" href="a00223.html#a238e5375b894d720b668240de35bbf39">  636</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> X::field_type <a class="code" href="a00223.html#a238e5375b894d720b668240de35bbf39" title="The field type of the preconditioner.">field_type</a>;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">// define the category</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keyword">enum</span> {</div>
<div class="line"><a name="l00641"></a><span class="lineno"><a class="code" href="a00223.html#a358dd40d97e0c008ced536116bf9366ba86e9b0a6a3c9de2436e3097d02c03377">  641</a></span>&#160;      category=<a class="code" href="a00262.html#ae061380ac961490be6ee353cf0dc1733add8be425650b870002d9381aea1203b9" title="Category for sequential solvers.">SolverCategory::sequential</a></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    };</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00649"></a><span class="lineno"><a class="code" href="a00223.html#a596ea4771e6325c620bd09b72816e0d4">  649</a></span>&#160;    <a class="code" href="a00223.html" title="Richardson preconditioner.">Richardson</a> (field_type w=1.0)</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      _w = w;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div>
<div class="line"><a name="l00659"></a><span class="lineno"><a class="code" href="a00223.html#a5816bb688fc11a0da944216cc29cfc2a">  659</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00223.html#a5816bb688fc11a0da944216cc29cfc2a" title="Prepare the preconditioner.">pre</a> (X&amp; x, Y&amp; b) {}</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div>
<div class="line"><a name="l00666"></a><span class="lineno"><a class="code" href="a00223.html#af6e4ea09bb9e83d9b8f85353ce1d1172">  666</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> apply (X&amp; v, <span class="keyword">const</span> Y&amp; d)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;          v = d;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      v *= _w;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="code" href="a00223.html#a9541bc08f1e78b247690d67158a0bd90">  677</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="a00223.html#a9541bc08f1e78b247690d67158a0bd90" title="Clean up.">post</a> (X&amp; x) {}</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    field_type _w;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  };</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;} <span class="comment">// end namespace</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jun 4 2012 12:02:18 for dune-istl by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1
</small></address>
</body>
</html>
